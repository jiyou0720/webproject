
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>게시물 페이지</title>
    <link rel="stylesheet" href="./post.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // 상세 정보를 불러와서 표시하는 함수
        function openProductDetail(id) {
            // AJAX를 사용하여 서버에서 상세 정보를 가져옴
            $.ajax({
                url: `/posts/${id}`,
                type: 'GET',
                success: function(res) {
                    var post = res;

                    // 새 창을 열어 상세 정보를 표시
                    var detailWindow = window.open('', '_blank');
                    detailWindow.document.write(`
                        <div class="detail-card">
                            <div class="img">
                                <img src="/${post.file_path}" alt="">
                            </div>
                            <div class="text">
                                <h2>${post.title}</h2>
                                <p>${post.content}</p>
                                <p>가격: ${post.price}</p>
                                <p>작성일: ${post.created_at}</p>
                            </div>
                        </div>
                    `);
                },
                error: function(err) {
                    console.log(err);
                    alert('상세 정보를 불러오는 데 실패했습니다.');
                }
            });
        }

        $(document).ready(function() {
            // 게시물 목록을 불러오는 AJAX 요청
            $.ajax({
                url: '/posts',
                type: 'GET',
                success: function(res) {
                    var posts = res;
                    for(var i = 0; i < posts.length; i++) {
                        var post = posts[i];
                        var postHtml = `
                            <div class="card">
                                <div class="img">
                                    <img src="/${post.file_path}" alt="">
                                </div>
                                <div class="text">
                                    <h2>${post.title}</h2>
                                    <p>${post.content}</p>
                                    <!-- 상세정보 확인 버튼에 onclick 추가 -->
                                    <button class="detail-btn" data-id="${post.id}" onclick="openProductDetail(${post.id})">
                                        <i class="fas fa-check"></i> 상세정보 확인
                                    </button>
                                </div>
                            </div>
                        `;
                        $('.item_list').append(postHtml);
                    }
                },
                error: function(err) {
                    alert('서버 오류가 발생하였습니다. 다시 시도해주세요.');
                }
            });
        });
    </script>
</head>
<body>
    <div class="nav">
        <div class="logo">
            <img src="./images/flea.png" alt="">
        </div>
        <div class="nav_but">
            <a href="">판매하기</a>
            <a href="">질문하기</a>
            <a href="">대화하기</a>
            <a href="">문의하기</a>
        </div>
    </div>

    <section class="header">
        <div class="title">
            <img src="./images/img4.jpg" alt="">
            <h1>안녕하세요</h1>
            <p>저는 유민입니다.</p>
            <button>행복하세영ㅋ</button>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="left">
                <h1>유민이 X 지유박 with 벼룩</h1>
                <p>https://www.youtube.com/watch?v=r2ko422xW0w&t=29s</p>
                <div class="sns">
                    <i class="fab fa-twitter"></i>
                    <i class="fab fa-facebook-square"></i>
                    <i class="fab fa-instagram"></i>
                    <i class="fab fa-github"></i>
                </div>
            </div>
            <div class="right">
                <div class="list">
                    <h2>연락처</h2>
                    <ul>
                        <li>아</li>
                        <li>뭐라</li>
                        <li>쓰지</li>
                        <li>지</li>
                    </ul>
                </div>
                <div class="list">
                    <h2>소개</h2>
                    <ul>
                        <li>니얼</li>
                        <li>굴</li>
                        <li>필라필라필라</li>
                        <li>현우진사랑해요</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="copy_right">
            <p>저작권은 박지유에게 있습니다.</p>
        </div>
    </footer>

    <section class="serv_list">
        <div class="container">
            <div class="title">
                <h1>벼룩없는 벼룩시장</h1>
                <button style="margin-left: 1000px;" onclick="location.href='/write'">새 글 작성</button>
                <ul>
                    <li><a href="">의류</a></li>
                    <li><a href="">문구</a></li>
                    <li><a href="">가전</a></li>
                    <li><a href="">주방</a></li>
                </ul>
            </div>
            <div class="item_list">
                <div class="card">
                    <div class="img">
                        <img src="./images/img1.jpg" alt="">
                    </div>
                    <div class="text">
                        <h2>React</h2>
                        <p>지성이 장착된 야도란은 야생에 자연 스폰된다.</p>
                        <button class="detail-btn" data-id="1"><i class="fas fa-check"></i> 상세정보 확인</button>
                    </div>
                </div>
                <div class="card">
                    <div class="img">
                        <img src="./images/img2.jpg" alt="">
                    </div>
                    <div class="text">
                        <h2>React</h2>
                        <p>지성이 장착된 야도란은 야생에 자연 스폰된다.</p>
                        <button class="detail-btn" data-id="2"><i class="fas fa-check"></i> 상세정보 확인</button>
                    </div>
                </div>
                <div class="card">
                    <div class="img">
                        <img src="./images/img3.jpg" alt="">
                    </div>
                    <div class="text">
                        <h2>React</h2>
                        <p>지성이 장착된 야도란은 야생에 자연 스폰된다.</p>
                        <button class="detail-btn" data-id="3"><i class="fas fa-check"></i> 상세정보 확인</button>
                    </div>
                </div>
                <div class="card">
                    <div class="img">
                        <img src="./images/img4.jpg" alt="">
                    </div>
                    <div class="text">
                        <h2>React</h2>
                        <p>지성이 장착된 야도란은 야생에 자연 스폰된다.</p>
                        <button class="detail-btn" data-id="4"><i class="fas fa-check"></i> 상세정보 확인</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="detail-container">
        <!-- 상세 정보를 표시할 컨테이너 -->
    </section>
    
</body>
</html>
